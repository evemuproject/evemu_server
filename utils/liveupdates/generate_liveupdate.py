def IncarnaNPEEnabled():
	import uicls
	layer = uicore.layer.Get('charactercreation')
	if ((layer is not None) and (getattr(layer, 'isPatched', None) is None)):
		import marshal
		patchedCode = '630100000008000000080000004700000073090100007c00006a00008300007d02007401006a02006401008301006a03006402006403006404006405007404006a05006406007c02008301037d03007c03006a06008300007407006a08006b02007201017c00006a09007c00006a0a008301007d0400740b007c04006407008302007d05007c05006a0c008300007d06007c05006a0d0083000001740e006a0f00640800690100640900640a0036830200017401006a1000640b008301006a11007c06008301007d07007c07006400006b080073cc007c07007413006b080072e600740e006a0f00640c00690100640d00640a0036830200016e1700740e006a0f00640800690100640e00640a003683020001741400537413005364000053280f0000004e740600000077696e646f7774140000006363436f6e6669726d6174696f6e57696e646f777406000000637265617465690100000074090000006465636f436c617373740500000070686f746f74020000007262740c000000437573746f6d4e6f74696679732a00000055706c6f6164696e6720796f7572206368617261637465722070686f746f20746f204556456d752e2e2e74060000006e6f74696679740e00000070686f746f55706c6f6164537663740c000000437573746f6d4e6f74666979732000000050686f746f2075706c6f616420746f204556456d7520686173206661696c6564732400000050686f746f2075706c6f616420746f204556456d7520776173207375636365737366756c28150000007411000000476574416374697665506f7274726169747402000000736d740c000000537461727453657276696365740900000047657457696e646f777404000000666f726d74140000004343436f6e6669726d6174696f6e57696e646f77740900000053686f774d6f64616c74070000007569636f6e7374740600000049445f5945537417000000476574506f727472616974536e617073686f74506174687413000000616374697665506f727472616974496e64657874040000006f70656e7404000000726561647405000000636c6f7365740300000065766574070000004d657373616765740900000052656d6f7465537663740600000055706c6f616474040000004e6f6e65740500000046616c73657404000000547275652808000000740400000073656c6674040000006172677352040000007403000000776e647408000000736e617050617468740900000070686f746f46696c65740900000070686f746f446174617406000000726573756c7428000000002800000000731600000067656e65726174655f6c6976657570646174652e7079741a00000041736b466f72506f727472616974436f6e6669726d6174696f6e0b000000731c00000000010c012d01150112010f010c010a011701180118011a0217010402'
		layer.AskForPortraitConfirmation.im_func.func_code = marshal.loads(patchedCode.decode('hex'))
		setattr(layer, 'isPatched', 1)
	return False

def AskForPortraitConfirmation(self, *args):
	photo = self.GetActivePortrait()
	wnd = sm.StartService('window').GetWindow('ccConfirmationWindow', create=1, decoClass=form.CCConfirmationWindow, photo=photo)
	if (wnd.ShowModal() == uiconst.ID_YES):
		snapPath = self.GetPortraitSnapshotPath(self.activePortraitIndex)
		photoFile = open(snapPath, 'rb')
		photoData = photoFile.read()
		photoFile.close()
		eve.Message('CustomNotify', {'notify': 'Uploading your character photo to EVEmu...'})
		result = sm.RemoteSvc('photoUploadSvc').Upload(photoData)
		if ((result is None) or (result is False)):
			eve.Message('CustomNotfiy', {'notify': 'Photo upload to EVEmu has failed'})
		else:
			eve.Message('CustomNotify', {'notify': 'Photo upload to EVEmu was successful'})
		return True
	else:
		return False

import marshal

file = open('liveupdate.raw', 'wb')
marshal.dump(IncarnaNPEEnabled.func_code, file)
file.flush()
file.close()

file = open('liveupdate_hex.txt', 'wb')
file.write(marshal.dumps(AskForPortraitConfirmation.func_code).encode('hex'))
file.flush()
file.close()

print 'all done'
