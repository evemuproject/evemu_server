<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>EVEmu Developer documentation</title>

    <!-- jQuery & QUnit -->
    <script type="text/javascript" src="js/jquery-1.4.2.js"></script>
    <script type="text/javascript" src="js/qunit.js"></script>
    <link type="text/css" rel="stylesheet" href="js/qunit.css"/>
    <!-- SyntaxHighlighter -->
    <script type="text/javascript" src="../syntaxhighlighter_3.0.83/scripts/shCore.js"></script>
    <script type="text/javascript" src="../syntaxhighlighter_3.0.83/scripts/shBrushBash.js"></script>
    <script type="text/javascript" src="../syntaxhighlighter_3.0.83/scripts/shBrushCpp.js"></script>
    <script type="text/javascript" src="../syntaxhighlighter_3.0.83/scripts/shBrushDiff.js"></script>
    <script type="text/javascript" src="../syntaxhighlighter_3.0.83/scripts/shBrushPython.js"></script>
    <script type="text/javascript" src="../syntaxhighlighter_3.0.83/scripts/shBrushSql.js"></script>
    <script type="text/javascript" src="../syntaxhighlighter_3.0.83/scripts/shBrushXml.js"></script>

    <link type="text/css" rel="stylesheet" href="../syntaxhighlighter_3.0.83/styles/shCoreDefault.css"/>
    <script type="text/javascript">SyntaxHighlighter.all();</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
  </head>
  <body>
    <h3>Client process network</h3>
&nbsp;&nbsp;Check that the connection is still valid.  if not return failure so the client is removed.
    <pre class="brush: cpp">
bool Client::ProcessNet()
{
    if( GetState() != TCPConnection::STATE_CONNECTED )
        return false;

    </pre>
&nbsp;&nbsp;Check if the ping timer has elapsed and send a ping request if neccesary,
    <pre class="brush: cpp">
    if(m_pingTimer.Check()) {
        //_log(CLIENT__TRACE, "%s: Sending ping request.", GetName());
        _SendPingRequest();
    }
    </pre>
&nbsp;&nbsp;
    <pre class="brush: cpp">
    PyPacket *p;
    while((p = PopPacket())) {
        {
            _log(CLIENT__IN_ALL, "Received packet:");
            PyLogDumpVisitor dumper(CLIENT__IN_ALL, CLIENT__IN_ALL);
            p->Dump(CLIENT__IN_ALL, dumper);
        }
    </pre>
&nbsp;&nbsp;
    <pre class="brush: cpp">
        try
        {
            if( !DispatchPacket( p ) )
                sLog.Error( "Client", "%s: Failed to dispatch packet of type %s (%d).", GetName(), MACHONETMSG_TYPE_NAMES[ p->type ], (int)p->type );
        }
        catch( PyException& e )
        {
            _SendException( p->dest, p->source.callID, p->type, WRAPPEDEXCEPTION, &e.ssException );
        }

        SafeDelete( p );
    }
    </pre>
&nbsp;&nbsp;Finally, send any updates that have been queued.
    <pre class="brush: cpp">
    // send queued updates
    _SendQueuedUpdates();

    return true;
}
    </pre>
    Simply copy and past the contents of this file into a new file and fill in your own content.
  </body>
</html>
